/*
 *		DML : select, insert, update, delete
 * 		--	insert,update,delete : db 반영 해줘야함
 */

create table dept01(
deptno number(4),
dname varchar(30),
loc varchar(20)
);

--	insert : 테이블에 새로운 데이터(내용) 입력
	--	단일 테이블
	insert into dept01(deptno, dname, loc) values(10, 'accounting', 'new york');
	
		--	전체 컬럼에 입력 시 : 컬럼명 생략
		insert into dept01	values(20, 'research', 'dallas');
	
		--	example)	emp 테이블의 4개 칼럼의 구조를 이용하여 SAM01 테이블을 서브쿼리를 이용하여 구조만 생성
		create table sam01
		as
		(select empno, ename, job, sal from emp where 1=0);	
		select * from sam01;
		
		insert into sam01	values(1000, 'apple', 'police', 10000);
		insert into sam01	values(1001, 'banana', 'nurse', 15000);
		insert into sam01	values(1002, 'orange', 'doctor', 25000);
		
			--	묵시적 null 값 삽입
			insert into dept01(deptno, dname) values(30, 'sales');
	
			--	명시적 null 값 삽입 : null, ''
			insert into dept01 values(50, '', 'chicago');
		
		--	서브쿼리를 이용하여 레코드(내용) 삽입
		create table dept02
		as
		(select * from dept where 1=0);
	
		insert into dept02 (select * from dept);		--	as 키워드 없음
		select * from dept02;
	
			--	example)	emp에 저장된 사원 중 10번 부서 소속 사원의 정보를 sam01 테이블에 추가
			insert into sam01 (select empno, ename, job, sal from emp where deptno = 10);
	
	--	다중 테이블에 다중 행 삽입
	create table emp_hir
	as
	(select empno, ename, hiredate from emp where 1=0);
	
	create table emp_mgr
	as
	(select empno, ename, mgr from emp where 1=0);
	
	insert all 
	into emp_hir values(empno, ename, hiredate)		--	values 명시됨
	into emp_mgr values(empno, ename, mgr)			--	values 명시됨
	(select empno, ename, hiredate, mgr from emp where deptno = 20);
	
	select * from emp_hir;
	select * from emp_mgr;
	
	
	
--	update
	--	특정 칼럼의 모든 레코드를 수정
	update emp01 set deptno = 30;
	select * from emp01;
	update emp01 set sal = sal * 1.1 where ename = 'SMITH';
	update emp01 set hiredate = sysdate;
	
	--	where절 이용 특정 레코드만 수정
	update emp01 set sal = sal * 1.1 where sal<=2000;
	update emp01 set hiredate = sysdate where substr(hiredate,1,2) = '87';	--	substr : hiredate 문자열에서 첫번째 문자부터 두개를 문자열로 리턴
	
	--	example)	sam01 테이블에서 급여가 10000 이상인 사원들의 급여만 5000씩 삭감
	update sam01 set sal = sal - 5000 where sal >= 10000;
	select * from sam01;
	
	--	테이블에서 2개 이상의 칼럼 데이터 변경
		--	example)	emp01 테이블에서 SCOTT의 부서번호를 20, 직급을 MANAGER로 변경
		update emp01 set deptno = 20, job = 'manager'	where ename = 'SCOTT';
		--	example)	emp01 테이블에서 SCOTT의 입사일을 오늘, 급여를50, 커미션을 4000 으로 변경
		update emp01 set hiredate = sysdate, sal = 50, comm = 4000 where ename = 'SCOTT';
		--	example)	dept01 테이블에서 20번 부서의 지역명을 10번 부서의 지역명으로 서브쿼리를 이용하여 변경
		update dept01 set loc = (select loc from dept01 where deptno = 20) where deptno = 10;
		select * from dept01;
		--	example)	서브 쿼리문을 사용하여 EMP 테이블에 저장된 데이터의 특정 컬럼(ename, sal,hiredate, deptno)으로 구성된 SAM02 테이블을 생성 하고
		--	dallas에 위치한 부서 소속 사원들의 급여를 1000 인상
		create table sam02
		as
		(select ename, sal, hiredate, deptno from emp);
		
		update sam02 set sal = sal + 1000 where deptno = (select deptno from dept where loc = 'DALLAS');
		select * from sam02;
		--	example)	부서 번호가 50번인 부서의 이름과 지역은 null과 CHICAGO이다. 
		-- 다음은 부서번호가 50인 부서의 부서명과 지역명을 부서 번호가 10번인 부서와 동일하게 변경하기 위한 UPDATE 명령문
		update dept01 set (dname,loc) = (select dname, loc from dept01 where deptno = 10) where deptno = 50;
		select * from dept01;
		
		--	example)	서브 쿼리문을 사용하여 SAM02 테이블의 모든 사원의 급여와 입사 일을 이름이 KING 인 사원의 급여와 입사일로 변경
		update sam02 set (sal, hiredate) = (select sal, hiredate from sam02 where ename = 'KING');
		select * from sam02;

--	delete	: 테이블의 데이터를 삭제
	delete from dept01 where deptno = 30;
	select * from dept01;
	select * from emp01;
	delete from emp01 where comm is not null;
	select * from emp01;
	delete from dept01;		--	주의 요망
	truncate table dept01;
	--	example)	SAM01 테이블에서 직책이 정해지지 않은 사원을 삭제
	delete from sam01 where job is null;
	select * from sam01;
	--	example)	emp01 테이블에서 서브쿼리를 이용하여 부서명이 SALES인 사원 삭제 
	delete from emp01 where deptno = (select deptno from dept01 where dname = 'SALES' );
