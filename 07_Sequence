--	오라클에서는 행을 구분하기 위해서 기본 키를 두고 있다. 
--	기본 키는 중복된 값을 가질 수 있으므로 항상 유일한 값을 가져야 한다.
--	시퀀스는 테이블 내의 유일한 숫자를 자동으로 생성하는 자동 번호 발생기이므로 시퀀스를 기본 키로 사용하게 되면 사용자의 부담을 줄일 수 있다.

/*	CREATE SEQUENCE sequence_name 
	1.	[START WITH n] : 시퀀스 번호의 시작값을 지정할 때 사용, 1부터 시작되는 시퀀스를 생성하려면 START WITH 1              
	2.	[INCREMENT BY n] : 연속적인 시퀀스 번호의 증가치를 지정할 때 사용, 1씩 증가하는 시퀀스를 생성하려면 INCREMENT BY 1이라고 기술
	3.	[{MAXVALUE n | NOMAXVALUE}] : 시퀀스가 가질 수 있는 최대값. NOMAXVALUE 를 지정하게 되면 ASCENDING 순서일 경우에는 10^27 DESCENDING일 경우에는 -1 
	4.	[{MINVALUE n | NOMINVALUE}] : 시퀀스가 가질수 있는 최소값을 지정한다. 만일 NOMINVALUE을 지정하게 되면 ASCENDING 순서일 경우에는 1이고 DESCENDING 순서일 경우에 는 1026승으로 설정된다.
 	5.	[{CYCLE | NOCYCLE}] : 지정된 시퀀스 값이 최대값까지 증가가 완료되게 되면 다시 START WITH 옵션에 지정한 시작 값에서 다시 시퀀스를 시작하도록 한다. NOCYCLE은 증가가 완료되게 되면 에러를 유발시킨다. 
	6.	[{CACHE n | NOCACHE}] : 메모리상의 시퀀스 값을 관리하도록 하는 것인데 기본 값은 20이다. NOCACHE는 원칙적으로 메모리 상에서 시퀀스를 관리하지 않는다.
*/

--	1. 시퀀스 생성
/*
 	최솟값 default : 1
 	최댓값 default : 10^27
 	cycle default : no
 	
 */
create sequence dept_deptno_seq
start with 1
increment by 1;

--	2.	시퀀스를 이용하여 레코드 입력
insert into dept01 values(dept_deptno_seq.nextval, 'test', '서울시');
insert into dept01 values(dept_deptno_seq.nextval, 'test2', '대전시');
select * from dept01;

delete from dept01 where loc = '대전시';

--	*.	시퀀스 관련 데이터 딕셔너리(메타데이터) 조회

--	3.	시퀀스 목록 보기
select * from seq;
select * from user_sequences;
select min_value from seq;
select max_value from seq;
select increment_by from seq;

--	4.	시퀀스 함수
	--	dual 의사테이블 이용			 
	select dept_deptno_seq.nextval from dual;
	
	
--	example)
	create sequence emp_seq 
	start with 1
	increment by 1
	maxvalue 100000;
	
	create table emp01(
	empno number(4) primary key,
	ename varchar(10),
	hiredate date
	);
	
	insert into emp01 values (emp_seq.nextval,'julia', sysdate);
	insert into emp01 values (emp_seq.nextval,'julia2', sysdate);
	select * from emp01;
	delete from emp01 where empno = 2;
	insert into emp01 values (emp_seq.nextval,'julia3', sysdate);	--	한번 삭제된 번호는 복원 할 수 없다.
	select * from emp01;	

--	5.	시퀀스 수정 : 시작값은 수정 불가
/*
ALTER SEQUENCE sequence_name 
[INCREMENT BY n] 
[{MAXVALUE n | NOMAXVALUE}] 
[{MINVALUE n | NOMINVALUE}] 
[{CYCLE | NOCYCLE}] 
[{CACHE n | NOCACHE}] 
*/	
	
--	6.	시퀀스 삭제 : 테이블과 달리 임시파일 없음
drop sequence seq_temp;
select * from seq;
select * from user_sequences;

--	7. 문자열+ 시퀀스 숫자
	--	테이블 생성
	create table board(
	bno	varchar(20) primary key,
	writer varchar(20) not null	
	);

	--	시퀀스 생성
	create sequence bno_seq
	start with 1001
	increment by 1;	
	--	시퀀스를 문자로 형변환 하여 레코드 입력 : 결합 연산자 || 이용
		--	게시물번호에 홍길동1001, 이순신1002 형태로 넣고자 하는 경우 (* 한글 1자리는 보통 3byte)
		insert into board values('홍길동'||to_char(bno_seq.nextval),'홍길동');
		insert into board values('이순신'||to_char(bno_seq.nextval),'이순신');
		
