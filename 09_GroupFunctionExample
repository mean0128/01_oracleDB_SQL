/*
 * 집합 함수(COUNT,MAX,MIN,SUM,AVG) 
 * 작업 대상 테이블 : EMP, STUDENT, PROFESSOR
 */

--Q1. EMP 테이블에서 소속 부서별 최대 급여와 최소 급여 구하기
	select deptno, max(sal), min(sal) from emp group by deptno;

--Q2. EMP 테이블에서 JOB의 수 출력하기
	select count(distinct job) from emp;
	
--Q3. EMP 테이블에서 전체 사원의 급여에 대한 분산과 표준편차 구하기
	select round(variance(sal),0), round(stddev(sal),0) from emp;		
	
--Q4. Professor 테이블에서 학과별 급여(pay) 평균이 400 이상 레코드 출력하기
	select deptno, avg(pay) from professor group by deptno having avg(pay) >= 400;
	
--Q5. Professor 테이블에서 학과별,직위별 급여(pay) 평균 구하기
	select deptno, position, avg(pay) from professor group by deptno, position order by deptno, position;
	
--Q6. Student 테이블에서 학년(grade)별로 
-- weight, height의 평균값, 최대값, 최소값을 구한 
-- 결과에서 키의 평균이 170 이하인 경우 구하기
	select grade, avg(height), min(height), max(height), avg(weight), min(height), max(height) from student group by grade having avg(height) <= 170;
